{{#section 'head'}}

<link rel='stylesheet' href="/css/datepicker.css">

{{/section}}

<section class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1>Reserva em Lote</h1>
                <a href="/reserva" class="btn btn-warning mt-2">
                    <i class="fas fa-arrow-left"></i> Voltar
                </a>
            </div>
            <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a href="/">Página Inicial</a></li>
                    <li class="breadcrumb-item"><a href="/reserva">Reserva de Salas</a></li>
                    <li class="breadcrumb-item active">Reserva em Lote</li>
                </ol>
            </div>
        </div>
    </div><!-- /.container-fluid -->
</section>

<section class="content">
    <div class="container-fluid">

        <div class="row">
            <div class="col">
                <form role="form" action="/reserva/createLote" method="POST" id="reservaForm">
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label class="control-label" for="idAtividade"><span class="text-danger">*</span>
                                    Atividade</label>
                                <input type="text" class="form-control {{hasError errors "atividade"}}" name="atividade"
                                    value="{{reserva.atividade}}" id="idAtividade">
                                <div class="invalid-feedback">{{showError errors "atividade"}}</div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label><span class="text-danger">*</span> Tipo</label>
                                <select class="form-control  {{hasError errors "tipo"}}" name="tipo" id="idTipo">
                                    <option value="">Selecione um tipo</option>
                                    <option value="Aula" {{isSelected reserva.tipo "Aula"}}>Aula</option>
                                    <option value="Defesa" {{isSelected reserva.tipo "Defesa"}}>Defesa</option>
                                    <option value="Exame" {{isSelected reserva.tipo "Exame"}}>Exame</option>
                                    <option value="Reunião" {{isSelected reserva.tipo "Reunião"}}>Reunião</option>
                                </select>
                                <div class="invalid-feedback">{{showError errors "tipo"}}</div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col">
                            <label> Dias da Semana</label>
                            <div class="form-group clearfix">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" name='dias' value='0' id="dom" type="checkbox">
                                    <label class="form-check-label" for="dom">Domingo</label>
                                </div>

                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" name='dias' value='1' id="seg" type="checkbox">
                                    <label class="form-check-label" for='seg'>Segunda-Feira</label>
                                </div>

                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" name='dias' value='2' id='ter' type="checkbox">
                                    <label class="form-check-label" for="ter">Terça-Feira</label>
                                </div>

                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" name='dias' value='3' id='qua' type="checkbox">
                                    <label class="form-check-label" for='qua'>Quarta-Feira</label>
                                </div>

                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" name='dias' value='4' id='qui' type="checkbox">
                                    <label class="form-check-label" for='qui'>Quinta-Feira</label>
                                </div>

                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" name='dias' value='5' id='sex' type="checkbox">
                                    <label class="form-check-label" for='sex'>Sexta-Feira</label>
                                </div>

                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" name='dias' value='6' id='sab' type="checkbox">
                                    <label class="form-check-label" for="sab">Sábado</label>
                                </div>

                            </div>
                        </div>
                    </div>


                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label><span class="text-danger">*</span> Sala</label>
                                <select class="form-control  {{hasError errors "sala"}}" name="sala" id="idSala">
                                    <option value="">Selecione uma das salas</option>
                                    {{#each salas}}
                                    <option value="{{id}}" {{isSelected ../reserva.sala id}}>{{nome}}</option>
                                    {{/each}}
                                </select>
                                <div class="invalid-feedback">{{showError errors "tipo"}}</div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class='col-md-5'>
                            <div class="form-group">
                                <label><span class="text-danger">*</span>Data Inicial:</label>

                                <div class="input-group" id="idDataInicialDisplay" style="cursor: pointer;">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="far fa-calendar-alt"></i>
                                        </span>
                                    </div>
                                    <div class="input-group-prepend" id="idDataInicialClear">
                                        <span class="input-group-text">
                                            <i class="fas fa-times"></i>
                                        </span>
                                    </div>
                                    <input type="text" class="form-control float-right" id="idDataInicialVal">
                                </div>
                                <!-- /.input group -->
                            </div>
                        </div>
                        <div class='col-md-5'>
                            <div class="form-group">
                                <label><span class="text-danger">*</span>Data Final:</label>

                                <div class="input-group" id="idDataTerminoDisplay" style="cursor: pointer;">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">
                                            <i class="far fa-calendar-alt"></i>
                                        </span>
                                    </div>
                                    <div class="input-group-prepend" id="idDataTerminoClear">
                                        <span class="input-group-text">
                                            <i class="fas fa-times"></i>
                                        </span>
                                    </div>
                                    <input type="text" class="form-control float-right" id="idDataTerminoVal">
                                </div>
                                <!-- /.input group -->
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-3">
                            <div class="bootstrap-timepicker">
                                <div class="form-group">
                                    <label><span class="text-danger">*</span> Hora de Início: </label>

                                    <div class="input-group date" id="timepicker" data-target-input="nearest">
                                        <input type="text"
                                            class="form-control datetimepicker-input {{hasError errors "horaInicio"}}"
                                            value="{{reserva.horaInicio}}" data-target="#timepicker" name="horaInicio"
                                            id="idHoraInicio" />
                                        <div class="input-group-append" data-target="#timepicker"
                                            data-toggle="datetimepicker">
                                            <div class="input-group-text"><i class="far fa-clock"></i></div>
                                        </div>
                                        <div class="invalid-feedback">{{showError errors "horaInicio"}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3">
                            <div class="form-group">
                                <label class="control-label"><span class="text-danger">*</span> Hora de Término:
                                </label>
                                <select class="form-control" name="horaTermino" value="{{reserva.horaTermino}}"
                                    id="idHoraTermino" {{hasError errors "horaTermino"}}>
                                    <option value=""></option>
                                    <option value="07:29" {{isSelected reserva.horaTermino "07:29"}}>07:29</option>
                                    <option value="07:59" {{isSelected reserva.horaTermino "07:59"}}>07:59</option>
                                    <option value="08:29" {{isSelected reserva.horaTermino "08:29"}}>08:29</option>
                                    <option value="08:59" {{isSelected reserva.horaTermino "08:59"}}>08:59</option>
                                    <option value="09:29" {{isSelected reserva.horaTermino "09:29"}}>09:29</option>
                                    <option value="09:59" {{isSelected reserva.horaTermino "09:59"}}>09:59</option>
                                    <option value="10:29" {{isSelected reserva.horaTermino "10:29"}}>10:29</option>
                                    <option value="10:59" {{isSelected reserva.horaTermino "10:59"}}>10:59</option>
                                    <option value="11:29" {{isSelected reserva.horaTermino "11:29"}}>11:29</option>
                                    <option value="11:59" {{isSelected reserva.horaTermino "11:59"}}>11:59</option>
                                    <option value="12:29" {{isSelected reserva.horaTermino "12:29"}}>12:29</option>
                                    <option value="12:59" {{isSelected reserva.horaTermino "12:59"}}>12:59</option>
                                    <option value="13:29" {{isSelected reserva.horaTermino "13:29"}}>13:29</option>
                                    <option value="13:59" {{isSelected reserva.horaTermino "13:59"}}>13:59</option>
                                    <option value="14:29" {{isSelected reserva.horaTermino "14:29"}}>14:29</option>
                                    <option value="14:59" {{isSelected reserva.horaTermino "14:59"}}>14:59</option>
                                    <option value="15:29" {{isSelected reserva.horaTermino "15:29"}}>15:29</option>
                                    <option value="15:59" {{isSelected reserva.horaTermino "15:59"}}>15:59</option>
                                    <option value="16:29" {{isSelected reserva.horaTermino "16:29"}}>16:29</option>
                                    <option value="16:59" {{isSelected reserva.horaTermino "16:59"}}>16:59</option>
                                    <option value="17:29" {{isSelected reserva.horaTermino "17:29"}}>17:29</option>
                                    <option value="17:59" {{isSelected reserva.horaTermino "17:59"}}>17:59</option>
                                    <option value="18:29" {{isSelected reserva.horaTermino "18:29"}}>18:29</option>
                                    <option value="18:59" {{isSelected reserva.horaTermino "18:59"}}>18:59</option>
                                    <option value="19:29" {{isSelected reserva.horaTermino "19:29"}}>19:29</option>
                                    <option value="19:59" {{isSelected reserva.horaTermino "19:59"}}>19:59</option>
                                    <option value="20:29" {{isSelected reserva.horaTermino "20:29"}}>20:29</option>
                                    <option value="20:59" {{isSelected reserva.horaTermino "20:59"}}>20:59</option>
                                    <option value="21:29" {{isSelected reserva.horaTermino "21:29"}}>21:29</option>
                                    <option value="21:59" {{isSelected reserva.horaTermino "21:59"}}>21:59</option>
                                    <option value="22:29" {{isSelected reserva.horaTermino "22:29"}}>22:29</option>
                                    <option value="22:59" {{isSelected reserva.horaTermino "22:59"}}>22:59</option>
                                </select>
                                <div class="invalid-feedback">{{showError errors "horaTermino"}}</div>
                            </div>
                        </div>
                    </div>

                    <input type="hidden" name="dataInicio" id="idDataInicio" value="{{reserva.dataInicio}}">
                    <input type="hidden" name="dataTermino" id="idDataTermino" value="{{reserva.dataTermino}}">
                    <input type="hidden" name="dataReserva" id="idDataReserva" value="{{reserva.dataReserva}}">

                    <button type="submit" class="btn btn-primary">Salvar</button>
                </form>
            </div>

        </div>

</section>




{{#section 'scripts'}}



<script src="/js/moment.min.js"></script>
<script src="/js/daterangepicker.js"></script>
<script src="/js/tempusdominus-bootstrap-4.js"></script>
<script src="/js/toastr.js"></script>

<script>


    const msg = {{{ jsoner msg }}};
    const reserva = {{{ jsoner reserva }}};


    $(function () {
        toastr.options = {
            positionClass: 'toast-top-center'
        };
        if (msg) toastr.error(msg)
        if (reserva) {
            $("#idDataInicio").val(reserva.dataInicio);
            $("#idDataTermino").val(reserva.dataTermino);

            $("#idDataInicialVal").val(moment(reserva.dataInicial).format('DD/MM/YYYY'));
            $("#idDataTerminoVal").val(moment(reserva.dataTermino).format('DD/MM/YYYY'));
        }

        $('#reservaForm').submit(function () {
            var dataReserva = moment().format('YYYY-MM-DD HH:mm:ss');
            $("#reservaForm #idDataReserva").val(dataReserva);
            return true;
        });

        $('#idDataInicialDisplay').daterangepicker({

            autoUpdateInput: false,
            singleDatePicker: true,
            alwaysShowCalendars: true,
            drops: "up",
            locale: {
                daysOfWeek: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sab"],
                monthNames: ["Janeiro", "Fevereiro", "Março", "Abril",
                    "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"]
            },
        });
        $('#idDataInicialDisplay').on('apply.daterangepicker', function (ev, picker) {
            $("#idDataInicio").val(picker.startDate.format('YYYY-MM-DD'));
            $("#idDataInicialVal").val(picker.startDate.format('DD/MM/YYYY'));
            $('#idDataTerminoDisplay').data('daterangepicker').minDate = picker.startDate;
        });
        $("#idDataInicialClear").on("click", function () {
            $("#idDataInicio").val('');
            $("#idDataInicialVal").val('');
            $('#idDataTerminoDisplay').data('daterangepicker').minDate = '';
        });

        $('#idDataTerminoDisplay').daterangepicker({
            autoUpdateInput: false,
            singleDatePicker: true,
            alwaysShowCalendars: true,
            drops: "up",
            locale: {
                daysOfWeek: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sab"],
                monthNames: ["Janeiro", "Fevereiro", "Março", "Abril",
                    "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"],
            },
        });
        $('#idDataTerminoDisplay').on('apply.daterangepicker', function (ev, picker) {
            $("#idDataTermino").val(picker.startDate.format('YYYY-MM-DD'));
            $("#idDataTerminoVal").val(picker.startDate.format('DD/MM/YYYY'));
            $('#idDataInicialDisplay').data('daterangepicker').maxDate = picker.startDate;
        });
        $("#idDataTerminoClear").on("click", function () {
            $("#idDataTermino").val('');
            $("#idDataTerminoVal").val('');
            $('#idDataInicialDisplay').data('daterangepicker').maxDate = '';
        });

        $('#timepicker').datetimepicker({
            format: 'HH:mm',
            stepping: 15,
            disabledTimeIntervals: [[moment({ h: 0 }), moment({ h: 7 })], [moment({ h: 22, m: 1 }), moment({ h: 24 })]]
        })

    })
</script>


{{/section}}